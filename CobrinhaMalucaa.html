<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Cobrinha Malucaa</title>
  <style>
    body {
      margin: 0;
      background: #e6d9ff;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      font-family: monospace;
      gap: 10px;
    }
    canvas {
      background: #f3ecff;
      image-rendering: pixelated;
      border: 14px solid #7a4fb3;
    }
    .overlay {
      color: #5a2d91;
      font-size: 18px;
      font-weight: bold;
    }
    .controls {
      display: grid;
      grid-template-columns: 60px 60px 60px;
      grid-template-rows: 60px 60px 60px;
      gap: 6px;
      margin-top: 10px;
    }
    .btn {
      background: #a855f7;
      border: none;
      border-radius: 12px;
      font-size: 22px;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 4px #7a4fb3;
    }
    .btn:active {
      transform: translateY(2px);
      box-shadow: 0 2px #7a4fb3;
    }
    .empty {
      background: transparent;
      box-shadow: none;
    }
  </style>
</head>
<body>
  <div class="overlay">üêç Cobrinha Malucaa üêç</div>

  <canvas id="game" width="480" height="480"></canvas>

  <div class="controls">
    <div class="empty"></div>
    <button class="btn" onclick="setDir(0,-1)">‚Üë</button>
    <div class="empty"></div>

    <button class="btn" onclick="setDir(-1,0)">‚Üê</button>
    <div class="empty"></div>
    <button class="btn" onclick="setDir(1,0)">‚Üí</button>

    <div class="empty"></div>
    <button class="btn" onclick="setDir(0,1)">‚Üì</button>
    <div class="empty"></div>
  </div>

  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");

    const size = 20;
    const tileCount = canvas.width / size;

    let snake;
    let direction;
    let food;
    let score;
    let speed = 110;

    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playScoreSound() {
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();

      osc.type = "square";
      osc.frequency.value = 700;
      gain.gain.value = 0.1;

      osc.connect(gain);
      gain.connect(audioCtx.destination);

      osc.start();
      osc.stop(audioCtx.currentTime + 0.12);
    }

    function initSnake() {
      snake = [{ x: Math.floor(tileCount / 2), y: Math.floor(tileCount / 2) }];
    }

    function spawnFood() {
      return {
        x: Math.floor(Math.random() * tileCount),
        y: Math.floor(Math.random() * tileCount)
      };
    }

    function reset() {
      initSnake();
      direction = { x: 0, y: 0 };
      score = 0;
      food = spawnFood();
    }

    function gameLoop() {
      update();
      draw();
    }

    function update() {
      if (direction.x === 0 && direction.y === 0) return;

      const head = {
        x: snake[0].x + direction.x,
        y: snake[0].y + direction.y
      };

      if (head.x < 0 || head.y < 0 || head.x >= tileCount || head.y >= tileCount) {
        reset();
        return;
      }

      for (let part of snake) {
        if (head.x === part.x && head.y === part.y) {
          reset();
          return;
        }
      }

      snake.unshift(head);

      if (head.x === food.x && head.y === food.y) {
        score++;
        playScoreSound();
        food = spawnFood();
      } else {
        snake.pop();
      }
    }

    function draw() {
      ctx.fillStyle = "#f3ecff";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      ctx.fillStyle = "#c084fc";
      ctx.fillRect(food.x * size, food.y * size, size, size);

      snake.forEach((part, index) => {
        ctx.fillStyle = index === 0 ? "#6b21a8" : "#a855f7";
        ctx.fillRect(part.x * size, part.y * size, size, size);
      });

      ctx.fillStyle = "#5a2d91";
      ctx.fillText("Score: " + score, 10, 20);
    }

    function setDir(x, y) {
      if (x !== 0 && direction.x === 0) direction = { x, y };
      if (y !== 0 && direction.y === 0) direction = { x, y };
    }

    document.addEventListener("keydown", e => {
      switch (e.key) {
        case "ArrowUp": setDir(0,-1); break;
        case "ArrowDown": setDir(0,1); break;
        case "ArrowLeft": setDir(-1,0); break;
        case "ArrowRight": setDir(1,0); break;
      }
    });

    reset();
    setInterval(gameLoop, speed);
  </script>
</body>
</html>
